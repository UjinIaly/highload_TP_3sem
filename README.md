# Проект по курсу "Проектирование высоконагруженных систем".

## 1. Тема и целевая аудитория

**Steam** — онлайн-сервис цифрового распространения компьютерных игр и программ, разработанный и поддерживаемый компанией Valve. Steam выполняет роль средства технической защиты авторских прав, платформы для многопользовательских игр и потокового вещания, а также социальной сети для игроков.

### Целевая аудитория

Ва августе 2023 года Steam пользуются 30 миллионов уникальных пользователей ежедневно и около 120 миллионов пользователей в месяц.

Распределение аудитории

| Страна       | Количество пользователей, млн | процент от общего количества |
| ------------ | ----------------------------- | ---------------------------- |
| США          | 13.7                          | 11.3%                        |
| Китай        | 11.4                          | 9.46%                        |
| Россия       | 9.5                           | 7.89%                        |
| Бразилия     | 4.9                           | 4.06%                        |
| Германия     | 3.6                           | 2.99%                        |
| Канада       | 3                             | 2.49%                        |
| Турция       | 2.8                           | 2.32%                        |
| Франция      | 2.8                           | 2.32%                        |
| Англия       | 2.6                           | 2.15%                        |
| Польша       | 2.4                           | 1.99%                        |
| Филипины     | 2.1                           | 1.74%                        |
| Украина      | 2                             | 1.66%                        |
| Япония       | 1.6                           | 1.32%                        |
| Южная Корея  | 1.5                           | 1.24%                        |
| Индонезия    | 1.4                           | 1.16%                        |
| Австралия    | 1.4                           | 1.16%                        |

Больше всего пользователей в Америке - 11.3%, Далее идёт Китай - 9.46%, И тройку лидеров замыкает Россия - 7.89%. Очевидно большая часть пользователей находится в Северной Америке и в Европе. 
### MVP
1. Регистрация пользователей.
2. Онлайн-магазин: покупка и скачивание игр
3. Автоматическое обновление игр
4. Кросс-платформенная игра.
5. Сообщество и общение.
6. Достижения и статистика.
7. Торговая площадка.

## 2. Расчет нагрузки

### 2.1 Продуктовые метрики

- Месячная аудитория(MAU) — 120.4 млн пользователей
- Дневная аудитория(DAU) — 70 млн пользователей
- Пик в день - 33 млн пользователей

У каждого пользователя есть:
 - Никнейм
 - Аватар
 - Библиотека игр

 Для каждой игры:
 - Скриншоты и видео из игр
 - Файлы игры


#### Среднее количество действий пользователя по типам

Средний пользователь в день делает следующие действия: Вход в аккаунт.
Просмотр библиотеки игр.
Заходит в игры.
Поиск информации об играх.
Обмен сообщениями с друзьями.
Участие в сообществах Steam.
Покупка и продажа игровых предметов.
Отслеживание новостей и обновлений игр.


| Метрика                               | Показатель |
| ------------------------------------- | ---------- |
| Авторизаций в день                    | 1          |
| Посещений в день                      | 70 млн     |
| Средняя продолжительность посещения   | 47 мин     |
| Добавление пользователя в друзья      | 0,14       |
| Покупка игр в день                    | 0,027      |
| Отзыв на игру в день                  | 0,027      |
| Скачивание/Обновление игр  в день     | 2          |
| Просмотра профилей в день             | 5          |
| Сообщения другим пользователям в день | 2          |


### Технические метрики
### Хранилище
На текущий момент в магазине Steam 149 855 игр. Большинство - инди-игры(81 629).
Для инди-игр средний размер возьмём 3 гб. Для игр, появившихся в Steam до 2014 года включительно, возьмем средний размер 10 гб. Для игр с 2015 возьмём средний размер 25 гб 
В среднем количество реизов год в Steam - 2222 Получаем 81 629 * 3 + 2 222 * 12 + 27 989 * 25 =  244 877 + 26 664 + 699 725 = 971 ТБ  нужно Steam для хранения по крайней мере по одной копии игры.
Также для каждой игры нужны файлы (скриншоты, видео) и текстовая информация для отображения в магазине. В среднем можно оценить в 15 МБ для одной игры. 
149 855 * 15 МБ ~ 2.2 ТБ для хранения доп информации.

Steam не даёт точные данные сколько всего зарегистрировано аккаунтов, известно лишь то, что id последнего зарегистрированного пользователя - 1062000000, значит пользователей скорее всего около 667 млн. Значит в хранилище нужно примерно 4 000ТБ

### Расширение хранилища
Из статистики прирост новых игр каждый год примерно 9%. Значит каждый год прирост дискового пространства будет примерно: 
6089 * 3 + 6 718 * 25 = 18 267 + 167 950 = 186 217 ГБ ~ 182 ТБ. где 6089 - инди игры.
За 2023 год в стиме появилось 18 млн новых пользователей, значит прирост пользователей каждый год будет примерно 18*6 = 108 ТБ.
Итого ежегодный прирост дискового пространства составляет: 290 ТБ.

### RPS

Авторизация:  
70 миллионов уникальных пользователей в сутки * 1 раз в сутки' / 86400 сек ~ 810,2 RPS*

Регистрация:  
'18 миллионов новых пользователей в год * 1 раз' / 86400 сек / 365 дней ~ 0,57 RPS*

Просмотр страниц игр в магазине:
'70 миллионов уникальных пользователей в сутки * 1 раз в сутки' / 86400 сек ~ 810,2 RPS*

Написание отзыва на игру в магазине:
'120.4 миллионов уникальных пользователей * 1 раз в год' / 86400 сек / 365 дней ~ 3,8 RPS*

Покупка игры в магазине:
'120.4 миллионов уникальных пользователей * 1 раз в год' / 86400 сек / 365 дней ~ 3,8 RPS*

Просмотр профилей пользователей:
'70 миллионов уникальных пользователей в сутки * 5 раз в сутки' / 86400 сек  ~ 4 050,9 RPS*

Написание комментария в профиль:
'120,4 миллионов уникальных пользователей * 1 раз в месяц' / 86400 сек / 30 дней  ~ 46,5 RPS*

Загрузка медиафайлов в профиль:
'120,4 миллионов уникальных пользователей * 1 раз в год' / 86400 сек / 365 дней ~ 3,8 RPS*

Добавление пользователя в друзья:
'70 миллионов уникальных пользователей в сутки * 1 раз в неделю' / 86400 сек / 7 дней ~ 115,7 RPS*

Отправка сообщения другим пользователям:
'70 миллионов уникальных пользователей в сутки * 10 раз в сутки' / 86400 сек  ~ 8 101,8 RPS*

Скачивание/ обновление игры:
'70 миллионов уникальных пользователей в сутки * 2 раза в сутки' / 86400 сек ~ 1 620,4 RPS*

### Сетевой трафик
Пиковый трафик загрузки за последние 48 часов - 19.1 ТБ/с.


## Источники

1. https://steamdb.info/app/753/charts/
2. https://worldpopulationreview.com/country-rankings/steam-users-by-country
3. https://earthweb.com/how-many-people-use-steam/
4. https://gamemag.ru/news/174513/steam-replay-2022
5. https://www.playground.ru/misc/news/v_2021_godu_igroki_proveli_v_steam_pochti_38_milliardov_chasov-1185120
6. https://wonderfullytech.com/how-much-storage-do-you-need-for-gaming-in-2022/